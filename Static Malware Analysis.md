### Preliminary Information on Static Malware Analysis Course

It is possible for the devices used by SOC Analysts in an organization to be infected with malware. In such cases, the analysts have the responsibility of detecting the malware and assessing its harmful effects. Once the necessary precautions have been taken and a secure environment has been established, the next step is to analyze the detected malware. Understanding the behavior of malware is crucial in identifying any potential security breaches that may have been overlooked. To have general information about malware analysis, you can access the relevant training at the address below:

  
  

**Malware Analysis**: [https://app.letsdefend.io/training/lessons/malware-analysis-fundamentals](https://app.letsdefend.io/training/lessons/malware-analysis-fundamentals) 

Malware analysis can basically be divided into 2 stages: "Static Malware Analysis" and "Dynamic Malware Analysis".

This training covers topics related to "Static Malware Analysis."

For information on Dynamic Malware Analysis, you can access the relevant training at the address below:

  
  

**Dynamic Malware Analysis**: [https://app.letsdefend.io/training/lessons/dynamic-malware-analysis](https://app.letsdefend.io/training/lessons/dynamic-malware-analysis) 

The primary emphasis of the training is on what Static Malware Analysis is, including an in-depth exploration of the analysis method, the techniques employed, and the valuable information these techniques offer to analysts. This training is designed as an entry-level course, ensuring that even individuals with limited knowledge of Malware Analysis can comprehend the content. It is highly recommended for candidates aspiring to work in the field of Static Malware Analysis, as well as anyone with an interest in the subject, to complete this training thoroughly without skipping any sections.

---

### Preparation for Course

This section includes some issues in preparation for training.

  
  

## **Essential Topics to Know**

Static Malware Analysis is a subject with technical details and requires a solid understanding of certain basic topics to comprehend these details. While advanced knowledge is not mandatory, having a good grasp of the following subjects will greatly enhance your understanding of static malware analysis.

Below are briefly explained the basic topics that need to be known in order to understand this training.

  
  

**Operating System Fundamentals**

Operating system knowledge refers to understanding the technical functioning principles of the components within an operating system. Malware is a specific type of software code designed to carry out malicious activities when executed on a target system. To successfully execute these malicious activities on the target system, the malware must be developed specifically for that particular system. For instance, malware designed exclusively for the Windows operating system cannot run on Linux, except in rare cases. This is because malware, typically appearing as executable files, is not developed to be compatible with Linux.

  
  

**Networking Basics**

Malware needs management to execute commands on an infected system. This management process is carried out through remote connections with command and control (C2) servers. To determine if there is access to these servers, as well as the methods and addresses used for this access, knowledge about the network is essential. While networking is a broad subject in its own right, a basic understanding of networks is sufficient for detecting malware access.

You can benefit from the following training sessions to have basic knowledge of network topics:

**Network Fundamentals**: [https://app.letsdefend.io/training/lessons/network-fundamentals](https://app.letsdefend.io/training/lessons/network-fundamentals) 

**Network Fundamentals II**: [https://app.letsdefend.io/training/lessons/network-fundamentals-ii](https://app.letsdefend.io/training/lessons/network-fundamentals-ii) 

**Network Protocols**: [https://app.letsdefend.io/training/lessons/network-protocols](https://app.letsdefend.io/training/lessons/network-protocols) 

**Network Protocols II**: [https://app.letsdefend.io/training/lessons/network-protocols-2](https://app.letsdefend.io/training/lessons/network-protocols-2) 

  
  

**Cryptology Basics**

The data encountered during malware analysis may sometimes be unclear and difficult to understand. Malware may use the data in a different form with various encoding techniques or transmit the network traffic between the Command and Control (C2) server in an encrypted way. In such situations, SOC analysts conducting static malware analysis may come across names of cryptological software libraries. If the SOC analyst is familiar with cryptology, they can identify the cryptographic algorithm being used and proceed with the analysis more effectively in this context. In this way, the results of the analysis may be more comprehensive and it may be possible to precisely explain the actions and methods employed by the malware. With detailed information about the malware, more effective measures can be taken against the attack methods utilized. Cryptology is an extensive field, and individuals seeking to train in this subject can find themselves engaged in a lifelong pursuit. However, during malware analysis, an exhaustive understanding of cryptology is often unnecessary. Basic knowledge of cryptology is sufficient. To obtain such foundational knowledge, you can access relevant training at the following address:

**Introduction to Cryptology**: [https://app.letsdefend.io/training/lessons/introduction-to-cryptography](https://app.letsdefend.io/training/lessons/introduction-to-cryptography) 

  
  

## **Lab Environment for Static Malware Analysis**

To successfully complete this training and solve the practical issues, you can utilize the special lab environment created by the LetsDefend team. The instructions provided below will assist you in setting up your own personalized lab environment for static malware analysis.

The lab environment designed for static malware analysis may be a standard malware analysis environment. It is crucial to analyze malware in isolated and virtual systems to prevent the possibility of infecting the host system during analysis.

**Note**: In this section, we will not cover the setup of the lab environment and related considerations. To learn how to create a lab environment for malware analysis, you can access the video tutorial provided below:

  
  

**Building a Malware Analysis Lab**: [https://app.letsdefend.io/training/lessons/building-malware-analysis-lab](https://app.letsdefend.io/training/lessons/building-malware-analysis-lab)   
  
This section of the training provides general information about the preparation for the training. In the next part, the "**Introduction**" of "Static Malware Analysis," which serves as an overview of the topic will be covered.

---

### Introduction to Static Malware Analysis

  
  

## **What is Malware Analysis?**

Malware Analysis is the systematic examination and investigation of malware to gather comprehensive technical insights. This process involves analyzing malware identified on systems within an organization or detected by another organization within its own systems.

  
  

## **Significance of Malware Analysis**

Malware Analysis is crucial to understand how attackers are using current threat actors. Malware developed by attackers may exploit previously unknown security vulnerabilities. In this case, detailed technical insights about these vulnerabilities can be obtained through malware analysis. However, in order for such an analysis to take place, the malware must first be detected and its file must be obtained. Otherwise, since there is no file to analyze, it will be impossible to detect the presence of the vulnerability.

  
  

## **What is Static Malware Analysis?**

Malware analysis may be categorized into two distinct stages:

- Static Malware Analysis
- Dynamic Malware Analysis

Static Malware Analysis refers to a set of techniques used to gather information about malware without executing it on the target system. In this approach, the malware file is uploaded to the prepared analysis environment, and analysis tools are employed to initiate the examination process.

The upcoming sections of the training delve into the implementation of static malware analysis using practical examples and highlighting the tools utilized for examination.

  
  

## **Significance of Static Malware Analysis**

The Static Malware Analysis phase is the first step to be performed starting with malware analysis. In this phase, information about the malware is gathered without executing it. The data obtained during this phase serves as a foundation for the subsequent stage, known as dynamic malware analysis. It may provide valuable insights that contribute to the analysis conducted during the dynamic malware analysis phase. In contrast to dynamic malware analysis, static malware analysis is a relatively easier and more comprehensive analysis method. It encompasses multiple aspects that need to be examined thoroughly. Throughout the malware analysis process, it is essential to conduct static malware analysis meticulously and document the obtained information. This is crucial since the information gathered during this stage can often contain critical insights for dynamic malware analysis. It is highly recommended that SOC analysts approach static malware analysis with caution and attention to detail.

  
  

In this part of the training, general information about malware analysis and static malware analysis is provided. **"Packing and Unpacking"** is explained in the next part of the training.

---

### Packing and Unpacking

  
  

## **What is Packing and Unpacking?**

"Packing" refers to the procedure of transforming an executable file into a different file format using a special algorithm for specific objectives. Conversely, "unpacking" denotes the process of reverting the packed file to its original form, essentially reversing the packing procedure.

Details about Packing/Unpacking operations are explained in the following topics.

  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/4.Packing+and+Unpacking/packing1.png)

  
  

The image displayed above shows the file structure of a Windows executable file both before and after the process of packing.

  
  

## **What Does Packing Provide?**

Packing uses an algorithm that causes structural changes to the executable file. This algorithm offers several significant advantages, including:

- Makes the executable file smaller in size.
- Prevents obtaining information about the file by static analysis using reverse engineering techniques.
- Prevents or makes detection by security products difficult.

  
  

## **How Does Unpacking Work?**

When an executable file is packed, it undergoes additional operations compared to an unpacked executable. These operations enable the packed file to execute successfully on the system. The following image illustrates this process step by step:

  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/4.Packing+and+Unpacking/packing2.png)

  
  

The process in the image above is briefly explained as follows:

1. The specific section highlighted in this stage is referred to as the entrypoint. It shows the initial step to be executed when the packed executable file is run. Due to the file being packed, the entrypoint points to the section containing the unpacker mechanism.
2. At this stage, unpacking is applied to the "Packed Executable" section using the unpacker.
3. At this stage, the "Original Unpacked Executable" resulting from the unpacking process in the previous stage is written to the empty section.
4. During this stage, control of the program flow transitions from the unpacker to the original executable.
5. Finally, the executable that has been successfully unpacked is executed.

  
  

## **Packers**

A packer refers to a tool or algorithm utilized to execute the packing process. Nowadays, packers are primarily employed for secure source code. They are used by both software vendors and attackers. The user base of packers can vary depending on the type employed.

There are commercial packers as well as custom packers written by the attackers themselves. Some of these are open source. Some packers are shown in the image below:

  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/4.Packing+and+Unpacking/packing3.png)

  
  
  
  

## **Types of Packers**

Categorizing packers into specific types can be challenging because a single packer may serve multiple purposes, making clear classification difficult. However, the following classification is provided as it is considered to be the most suitable one:

**Note**: It should be noted that a different classification may be included in another source. 

Packers may be divided into 3 groups: 

- Compressing Packers
- Encrypting Packers(Crypters)
- Protecting Packers(Protectors)

  
  

**Compressing Packers**

 "Compressing packers" are packers that reduce the size of an executable file.  In the past, these packers were commonly used to address limitations posed by slow internet speeds and limited storage capacity. However, currently, technology has reached a certain maturity and the size of executable files is no longer a significant concern.

  
  

**Encrypting Packers(Crypters)**

Encrypting packers (Crypters) are designed to encrypt the executable file, making it exceedingly challenging to extract information using static malware analysis techniques. Additionally, encrypting packers pose difficulties for security solutions in detecting malware. Malware developers frequently employ this type of packer to make their malware fully undetectable (FUD).

  
  

**Protecting Packers(Protectors)**

Protecting packers are a type of packer used by software developer vendors. With these packers, software vendors aim to prevent the source code of executable files of their products from being intercepted by reverse engineering techniques. These packers usually use both compressing algorithms and encryption algorithms.

**Note**: Since packers are not strictly separated by their functions, an attacker can use a packer with both compressing and encryption capabilities as a packer to make the malware fully-undetectable (FUD). SOC analysts are recommended to take this into account when performing static malware analysis.

  
  

## **How to Identify Packers Automatically and Manually?**

When analyzing a malware statically, it is of great advantage to know whether packing operations have been applied or not. Because static analysis of a packed malware before it is unpacked provides almost no useful information about the executable file. Therefore, packed malware should be unpacked first. To achieve this, it is crucial to determine the packing algorithm employed. Both automatic and manual methods can be employed to detect the specific packing algorithm used. Automatic methods involve utilizing packer detection tools, while manual methods entail examining the file with the assistance of analysis tools. The automatic method is generally easier to apply and saves time. However, packer detection tools may not be effective in static analysis when dealing with malware that uses custom packers. In such cases, it becomes necessary to employ the manual method to understand the packing algorithm, which can be time-consuming and less desirable for SOC analysts.

In the headings below, automatic and manual methods are applied on the same malware and the packing algorithm used is determined.

  
  

## **Detecting Packers with DIE(Detect It Easy)**

Numerous tools are available for determining the packer used in a malware sample. This tutorial utilizes the "DIE (Detect It Easy)" tool for packer detection. You can access the tool from the following address:

**DIE(Detect It Easy):** [https://github.com/horsicq/DIE-engine/releases](https://github.com/horsicq/DIE-engine/releases) 

One packer detection tool may not detect every packer. Therefore, it is recommended to use more than one packer detection tool. Some packer detection tools are as follows:

- DIE(Detect It Easy)
- PEStudio
- CFF Explorer
- PEiD
- ExeinfoPE

For instance, let's find out which packer a malware is packed using the "DIE (Detect It Easy)" tool:

**Note**: The example malware file, "eabfb9aaa4d1adec7c124bd0bda7a81c53249f2bac5743bedf67adf705d0d0d1f4.zip," is located within the "CourseFiles" directory on the Windows system used for training.

**ZIP Password**: infected

  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/4.Packing+and+Unpacking/packing4.png)

  
  

Upon launching the DIE tool,  a window like the one above appears. The malware file is given to the program with the help of the button on the top right.

  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/4.Packing+and+Unpacking/packing5.png)

  
  

As demonstrated in the image above, the tool successfully detected the packer used to package the malware. Similar tools, including this one, employ signatures to identify specific packers during the detection process.

**Note:** It would be more useful to perform the analysis considering that a packer may have more than one different signature. Packers may have varying signatures depending on their version.

There is a list of signatures of some packers in the address below.

**Packer Signature List**: [https://github.com/sooshie/packerid/blob/master/userdb.txt](https://github.com/sooshie/packerid/blob/master/userdb.txt) 

To further illustrate the process, we can open the malware file in a hex editor called "HxD" and utilize its search feature to find the signature associated with the packer. 

**Signature(Hex)**: 60 E8 03 00 00 00 E9 EB 04 5D 45 55 C3 E8 01 00 00 00 EB 5D BB ED FF FF FF 03 DD 81 EB

  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/4.Packing+and+Unpacking/packing6.png)

  
  
  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/4.Packing+and+Unpacking/packing7.png)

  
  

As seen in the image above, the signature we are looking for is located at 4201 offset.

  
  

## **Detecting Packers Manually**

In the previous topics, it is determined which packer packs the malware automatically and with the help of a tool. Under this title, a method that can be used to detect the packer manually is explained. In this method, we focus on the **"Section Name"** of the executable file. The table below presents the section names associated with several packers:

  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/4.Packing+and+Unpacking/packing8.png)

  
  

It is possible to find the packer by searching section names with static malware analysis tools. The following tools are available for this:

- PEview
- PE-bear
- Stud_PE

To further investigate the malware that was identified using the automatic packer detection method mentioned earlier, we can analyze its sections using the PE-bear tool:

  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/4.Packing+and+Unpacking/packing9.png)

  
  

 In the image above, the malware file is opened with the PE-bear tool and its sections are displayed. Upon examining the section names, it is seen that there are section names specified for the **"Aspack"** packer in the table above. This indicates that the malware was indeed packed using the **"Aspack"** packer.

  
  

**Note:** In this training module, section names have been utilized for manual packer detection. However, it is crucial to bear in mind that there are numerous other aspects within the malware that can be explored during manual packer detection. It is vital not to overlook the exploration of alternative areas if packer detection proves to be challenging or inconclusive.  
  
This training section covers various aspects related to packing and unpacking, the benefits of packing, the operating logic of unpacking, different types of packers, and techniques for detecting packers manually and automatically. The subsequent part of the training delves into the topic of **"Unpacking Packed Malware"** which involves a practical application on malware.

### Course Files

[eabfb9aaa4d1adec7c124bd0bda7a81c53249f2bac5743bedf](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/Files/Packing+and+Unpacking/eabfb9aaa4d1adec7c124bd0bda7a81c53249f2bac5743bedf67adf705d0d1f4.zip)

Password: infected

### Lab Environment

Connect

### Questions Progress

Correct

**Question:** In which packer/protector is the executable packed?  
  
**File Location:** C:\Users\LetsDefend\Desktop\QuestionFiles\PackingAndUnpacking\psexec.zip  
  
**File Password:** infected

Completed

Hint

Correct

**Question:** What is the version of the packer used on this executable file?  
  
**File Location:** C:\Users\LetsDefend\Desktop\QuestionFiles\PackingAndUnpacking\psexec.zip  
  
**File Password:** infected

Completed

Hint

Correct

**Question:** What is the specific section name used by the packer on this executable?  
  
**File Location:** C:\Users\LetsDefend\Desktop\QuestionFiles\PackingAndUnpacking\psexec.zip  
  
**File Password:** infected

Completed

Hint


---

### Unpacking Packed Malware

In this section, a packed malware will be unpacked by determining which packer was used to pack it.

**Note**: In this example, the malware file named "57e6e8afb83fe29962ebd9a164d8bac6155d825897d08d94eb7cd5c71eb9d184.zip" can be found in the "CourseFiles" directory on the Windows system used for training.

**ZIP Password**: infected

First, we will find out the packer information with the **"CFF Explorer"** tool:

  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/5.Unpacking+Packed+Malware/cff1.png)

  
  

As can be seen in the image above, "UPX" packer name is written in the "File Info" section. The sections of the executable file are also as follows:

  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/5.Unpacking+Packed+Malware/cff2.png)

  
  

The image above displays the section names of the UPX packer. Through analysis of the **"File Info"** and **"Section"** sections, it has been concluded that the malware in question was packed with the UPX packer.

Once the packer used has been identified, the next step is to unpack the executable file using the appropriate tool. In the case of UPX packer, since it is an open-source packer, the required tool for unpacking is readily available on the internet. You can access the tool at the following address:

**UPX**: [https://upx.github.io/](https://upx.github.io/) 

**Note**: If a different packer was used and no readily available unpacking tool existed, the unpacking process would involve writing custom unpacking code or utilizing dynamic reverse engineering tools to analyze the executable file and extract the unpacked version.

The "CFF Explorer" tool includes a UPX unpacker itself, which allows for quick and efficient unpacking directly from the "UPX Utility" section.

  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/5.Unpacking+Packed+Malware/cff3.png)

  
  

After the executable file has been unpacked using the "Unpack" button seen in the image above, the "File Info" field in the "File" menu on the left is checked.

  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/5.Unpacking+Packed+Malware/cff4.png)

  
  

As depicted in the image, the field that previously displayed "UPX" no longer indicates the presence of UPX after the unpacking process. This change signifies that the executable file has been successfully unpacked. The sections of the unpacked executable file are analyzed and examined: 

  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/5.Unpacking+Packed+Malware/cff5.png)

  
  

As evident from the image, the sections of the unpacked Windows executable file appear in the expected arrangement, resembling a typical unpacked executable. This indicates that the unpacking operation has been carried out successfully.

The executable file unpacked via CFF Explorer is not saved as a separate file within the system. If the program is closed, the unpacking process needs to be repeated on the file. However, it is possible to export and save the unpacked executable file using CFF Explorer. To save the unpacked file, the steps "File -> Save As" should be followed from the top menu.

  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/5.Unpacking+Packed+Malware/cff6.png)

  
  

If the steps in the image above are applied, the unpacked version of the executable file will be saved.

  

In this part of the training, packer detection and unpacking process have been applied to real malware. In the next part of the training, "**File Format Analysis**" will be explained.

### Course Files

[57e6e8afb83fe29962ebd9a164d8bac6155d825897d08d94eb](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/Files/Unpacking+Packed+Malware/57e6e8afb83fe29962ebd9a164d8bac6155d825897d08d94eb7cd5c71eb9d184.zip)

Password: infected

### Lab Environment

Connect

### Questions Progress

Correct

**Question:** Which packer was used to pack the executable?  
  
**File Location:** C:\Users\LetsDefend\Desktop\QuestionFiles\UnpackingPackedMalware\3da155bcee7727b04f3715a85e7beaa3ff55bbecd100457b2a6dcbc3a6850fed.zip  
  
**File Password:** infected

Completed

Hint

Correct

**Question:** How many sections are there in the executable file?  
  
**File Location:** C:\Users\LetsDefend\Desktop\QuestionFiles\UnpackingPackedMalware\3da155bcee7727b04f3715a85e7beaa3ff55bbecd100457b2a6dcbc3a6850fed.zip  
  
**File Password:** infected

Completed

Hint

Correct

**Question:** How many sections does the unpacked version of the executable file contain?  
  
**File Location:** C:\Users\LetsDefend\Desktop\QuestionFiles\UnpackingPackedMalware\3da155bcee7727b04f3715a85e7beaa3ff55bbecd100457b2a6dcbc3a6850fed.zip  
  
**File Password:** infected

Completed

Hint

Correct

**Question:** What is the MD5 hash of the unpacked version of the executable file?  
  
**File Location:** C:\Users\LetsDefend\Desktop\QuestionFiles\UnpackingPackedMalware\3da155bcee7727b04f3715a85e7beaa3ff55bbecd100457b2a6dcbc3a6850fed.zip  
  
**File Password:** infected

Completed

Hint

---

### File Format Analysis

  
  

## **What is File Format?**

Files have their own unique structure. Each different file type has a different number and length of fields. In order for programs to interpret and extract meaningful information from files, a specific file structure known as the "File Format" is essential. Operating systems require knowledge of this file format to read files correctly. Without understanding the file format, the operating system cannot accurately parse the file's fields or comprehend the data contained within it. For instance, Windows executable files with the ".exe" extension cannot be directly executed on Linux. Additional tools that can parse the file format are needed to run them.

  
  

## **Significance of File Format in Static Malware Analysis**

In static malware analysis, understanding the file format of the malware is crucial. The file format provides valuable information about which operating system the malware is aimed at and/or which software can be used to run the malware. For example, when a malware with ".exe" extension is encountered, it indicates that the malware is designed for the Windows operating system. Similarly, when a malware with ".docx" extension is seen, it indicates that the malware aims to infect the system or perform malicious activities using office programs. In static malware analysis, determining the file format is vital as analysis methods and tools may vary depending on the format. Additionally, each file format has its distinct characteristics which means that the attack vectors may also vary. For instance, thanks to the macro feature in office files with ".docx" extension, malware can be embedded in the file with "VisualBasic". When the macro is executed, the malware runs.

  
**Challenge:** [Malicious VBA](https://app.letsdefend.io/challenge/Malicious-VBA)  
  
  

Similarly, malicious "JavaScript" codes can be embedded in PDF files.

  
  

## **File Header**

When determining the format of a file, the part to examine is the file header. This is because the file header differs for each file type. The "magic bytes" field in the file header is a field that consists of the initial few bytes of the file and provides insights into the file type. In other words, magic bytes is the signature of the file.

For access to the signatures and extensions of numerous file types, you can visit the following address:

**List of File Signatures**: [https://en.wikipedia.org/wiki/List_of_file_signatures](https://en.wikipedia.org/wiki/List_of_file_signatures) 

"Hex Editor" tools can be utilized to examine the file header and magic bytes fields. For example, the image below demonstrates the file headers of Windows executable (PE file) files.

  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/6.File+Format+Analysis/format1.png)

  
  

The following address can be used to examine the images showing the headers of files with different file formats: 

**File Formats**: [https://github.com/corkami/pics/blob/master/binary/README.md](https://github.com/corkami/pics/blob/master/binary/README.md) 

  
  

## **File Extensions**

A file extension is an appendage added to the end of the file name that gives information about the format of the file. Typically, each different file type has its own extension. For example, ".html" is the extension for web pages that contain HTML code. Below are statistics on the file extensions most commonly used by malware in 2020:

  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/6.File+Format+Analysis/format2.png)

  
  

(Image Source: [https://www.statista.com/statistics/1238996/top-malware-by-file-type/](https://www.statista.com/statistics/1238996/top-malware-by-file-type/) )

  
  

## **File Type and File Extension Mismatch**

Typically, the file extension provides accurate information about the file format. However, in certain cases, attackers can deceive their targets by disguising the extension and successfully execute their attacks. For instance, the file in the image below appears to be a "PDF" file looking at its extension.

  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/6.File+Format+Analysis/format3.png)

  
  

However, the **"File name extensions"** option on Windows must be activated to find out if this is really a PDF file.

  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/6.File+Format+Analysis/format4.png)

  
  

As can be seen in the image above, it cannot be definitively concluded that the file is a PDF file since the option to display file extensions is not enabled. Upon enabling this feature, let's see the file extension:

  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/6.File+Format+Analysis/format5.png)

  
  

The image above shows that the actual extension of the file is ".exe".

  
  

## **File Thumbnail Faking**

In addition to the method described in the previous topic, attackers may also modify the thumbnail image associated with the file to enhance the effectiveness of their attack. By doing so, they not only conceal the actual file extension but also prevent the user from learning the real file format. For instance, in the previous example, the thumbnail of the file reveals that it is not a PDF file but instead a Windows executable file.

  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/6.File+Format+Analysis/format6.png)

  
  

However, when viewing the file as shown in the image above, it is easy to initially mistake it for a PDF file.

  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/6.File+Format+Analysis/format7.png)

  
  

Upon enabling the option to display file extensions, it becomes evident that the file in question is not a PDF file, but rather a file with the ".exe" extension. 

  
  

## **How to Identify File Type Automatically?**

In some cases, it may be necessary to find out the file type with the help of a tool. When a large number of files need to be analyzed in a short time, for instance, it may be necessary to use tools that automatically detect the file type to save time.

**File Type Identification with DROID Tool**

The "DROID" tool, which runs on the Windows operating system and has a graphical user interface (GUI), is one of the tools used to detect file types. You can access the DROID tool from the address below:

**DROID**: [https://www.nationalarchives.gov.uk/information-management/manage-information/preserving-digital-records/droid/](https://www.nationalarchives.gov.uk/information-management/manage-information/preserving-digital-records/droid/) 

When the DROID tool is initially launched, a tab similar to the one depicted below is displayed:

  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/6.File+Format+Analysis/format8.png)

  
  

The files to be analyzed are provided to the tool via the **"Add"** button.

  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/6.File+Format+Analysis/format9.png)

  
  

Once the files are added, the process is initiated and the results are seen by clicking the **“Start”** button.

  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/6.File+Format+Analysis/format10.png)

  
  

As demonstrated in the image above, the file format information of files is successfully obtained.

**File Type Identification with Online Web Services**

In static malware analysis, it is possible to use online web services to determine the file type of the malware. By uploading the file of the malware to online web services, the file type can be learned.

**Note**: When detecting malware file types using online services, it should be considered that the file is uploaded to the target website. If sharing the file with the target web address poses a critical and inconvenient situation, performing the analysis in isolated sandbox environments using offline tools is recommended.

For example, a file type detection is performed using the online web address **"checkfiletype.com"** below:

  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/6.File+Format+Analysis/format11.png)

  
  

There are numerous web addresses used for identifying the file type. Some of these addresses are listed below:

- [http://www.detectfiletype.com/](http://www.detectfiletype.com/) 
- [https://filext.com/](https://filext.com/) 
- [https://filetypechecker.com/](https://filetypechecker.com/) 
- [https://www.sisik.eu/file](https://www.sisik.eu/file)  
- [https://www.aconvert.com/analyze.html](https://www.aconvert.com/analyze.html) 
- [https://www.checkfiletype.com/](https://www.checkfiletype.com/) 
- [https://www.toolsley.com/file.html](https://www.toolsley.com/file.html) 

  
  

## **How to Identify File Type Manually?**

In static malware analysis, file type detection can typically be accomplished using tools or simple methods. However, for custom file types and/or files with damaged file headers, manual examination may be required. In such situations, the file's signature can be identified, and the file type can be determined with the assistance of hex editor tools.

You can access the hex editor tool named "HxD" seen in the image below from the following address:

**HxD**: [https://mh-nexus.de/en/hxd/](https://mh-nexus.de/en/hxd/) 

For example, the signature of a Windows executable file is shown below on the hex editor:

  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/6.File+Format+Analysis/format12.png)

  
  

As observed in the provided image, the file's signature was detected using the hex editor, leading to the identification of the file as a Windows executable.

In this section of the training, we have covered the concept of file format and its significance in static malware analysis. We have explored the role of file headers and file extensions in identifying the file format, as well as the various techniques employed by attackers to conceal the true file format. Additionally, we have discussed different methods and tools used for file type detection. Moving forward to the next part of the training, we will delve into the topic of "File Hash”.

### Lab Environment

Terminate the  
"Reverse-Engineering-1" and connect againTerminate

### Questions Progress

Correct

**Question:** What is the extension of the file contained within the given zip file, based on its format?  
  
**File Location:** C:\Users\LetsDefend\Desktop\QuestionFiles\FileFormatAnalysis\unknown1.zip  
  
**File Password:** infected

Completed

Hint

Correct

**Question:** How many of the files contained within the given zip file are Windows executable files?  
  
**File Location:** C:\Users\LetsDefend\Desktop\QuestionFiles\FileFormatAnalysis\unknown2.zip  
  
**File Password:** infected

Completed

Hint

Correct

**Question:** What is the hex value of the magic number in the file header of Windows executable files with the ".exe" extension?  
  
**Note:** Enter the hex values without any spaces between them.

Completed

Hint

Correct

**Question:** What is the extension of the given file?  
  
**File Location:** C:\Users\LetsDefend\Desktop\QuestionFiles\FileFormatAnalysis\document

Completed

Hint


---

### File Hash

  
  

## **What is File Hash?**

A hash is a value generated by a hash algorithm through mathematical calculations applied to a given set of data. Here, the input data for the hash algorithm is the file containing the malware. This specific type of hash is commonly called a "file hash." It serves as a distinct signature for files.

  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/7.File+Hash/file-hash1.png)

  
  

(Image Source: [https://www.poeticoding.com/hashing-a-file-in-elixir/](https://www.poeticoding.com/hashing-a-file-in-elixir/))

  

**Note**: Hash functions are a broad subject within the field of cryptology. While this course provides an overview of hash functions, it does not delve into the topic extensively. Instead, the focus here is on explaining the hash functions and their use in terms of static malware analysis. To learn about hash functions, you can access the related training from the link below:

**Introduction to Cryptology**: [https://app.letsdefend.io/training/lessons/introduction-to-cryptography](https://app.letsdefend.io/training/lessons/introduction-to-cryptography) 

  
  

## **Finding the Hash of the File with the Tool**

One of the primary resources in static malware analysis is existing analysis reports, which play a crucial role. The hash value of a file is employed to access these analysis reports. By searching the hash value of a file in well-known signature databases, it is possible to determine if the malware has been previously analyzed and obtain the corresponding analysis results. This approach offers the advantage of avoiding the need to upload the malware file to online sandbox environments. Consequently, if the goal is to prevent the malware file from being publicly published through online sandbox environments, this method ensures confidentiality. However, it is essential to note that if a newly encountered malware lacks preliminary analysis, no analysis reports can be accessed using its hash value.

This section of the training demonstrates various methods for calculating the hash value of a malware file.

There are several tools used to calculate the hash of a file. For example, below "**HashCalc**" is used to calculate the hash value of the malware.

  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/7.File+Hash/file-hash2.png)

  
  

When the HashCalc tool is launched, it appears as shown in the image above. It is possible to calculate both hash values of files and hash values of texts via the HashCalc tool.  To do so, the appropriate option in the **"Data Format"** field located in the top-left corner should be chosen.  **"File"** as the data format option should be selected:

  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/7.File+Hash/file-hash3.png)

  
  

After selecting the data format, the malware file is provided to the tool for hash calculation.

  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/7.File+Hash/file-hash4.png)

  
  

After selecting the desired hash algorithm for hash calculation using HashCalc as in the above example, the hash values are calculated by clicking the "**Calculate**" button located at the bottom right of the tool.

  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/7.File+Hash/file-hash5.png)

  
  

As can be seen in the image above, the hash of the malware has been successfully calculated for various hash functions. While the "HashCalc" tool demonstrated above is quite helpful in calculating the hash of individual files, it may not efficiently handle the computation of hash values for multiple files simultaneously. In such cases, alternative tools like **"HashTools"** are more suitable for calculating the hash of multiple files.

The "**HashTools**" tool features a graphical user interface that closely resembles the one shown above. When HashTools is initially launched, it will appear as the following:

  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/7.File+Hash/file-hash6.png)

  
  

The files whose hash will be calculated are added to the tool with the help of the buttons in the upper left part of the window seen in the image above. After the files are added, the hash calculation can be performed according to the desired hash algorithm with the help of the buttons at the bottom of the window.

  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/7.File+Hash/file-hash7.png)

  
  

As seen in the image above, the hash values of the files have been successfully calculated in accordance with the MD5 hash algorithm. With this tool, the hash of multiple files can be calculated rapidly. However, calculations are allowed for only one hash algorithm at a time. It is recommended to consider this when deciding which hash tool to use.

The following tools running on Windows can also be used to find the file hash:

**HashMyFiles**: [https://www.nirsoft.net/utils/hash_my_files.html](https://www.nirsoft.net/utils/hash_my_files.html) 

**QuickHash**: [https://www.quickhash-gui.org/](https://www.quickhash-gui.org/)  

  
  

## **Obtaining The Hash of The File Through Powershell**

In certain scenarios, it may be necessary to calculate file hashes via the command line. In Windows, file hashes can be easily calculated using Powershell. For example, let's calculate the hash of malware using Powershell:

**Command**: Get-FileHash .\eabfb9aaa4d1adec7c124bd0bda7a81c53249f2bac5743bedf67adf705d0d1f4.exe | Format-List

  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/7.File+Hash/file-hash8.png)

  
  

As shown in the image above, the file hash can be calculated using the "**Get-FileHash**" command in PowerShell. The command can work with just a single parameter, which is the file's name. By default, the calculation is performed using the SHA256 hash function. If a different hash function is needed, the **"-Algorithm"** parameter should be added. As an instance of this, let's calculate the hash of the same malware file using the MD5 hash function.

**Command**: Get-FileHash .\eabfb9aaa4d1adec7c124bd0bda7a81c53249f2bac5743bedf67adf705d0d1f4.exe -Algorithm MD5 | Format-List

  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/7.File+Hash/file-hash9.png)

  
  

As in the image above, the hash calculation for the MD5 hash function has been performed successfully.

**Note**: The PowerShell command mentioned above, "Format-List," enables the output to be presented in a list format. When this command is omitted, the output will be displayed on a single line.

  
  

## **Information Gathering with File Hash**

The previous section demonstrated the process of calculating the hash of a malware file. In this part of the training, the various resources that can be utilized to gather information about malware are introduced using the hash value. The following list of resources can be used to collect information about the malware using File Hash:

- **VirusTotal**: [https://www.virustotal.com/gui/home/search](https://www.virustotal.com/gui/home/search) 
- **AnyRun**: [https://app.any.run/submissions/](https://app.any.run/submissions/) 
- **Joe Sandbox**: [https://www.joesandbox.com/#windows](https://www.joesandbox.com/#windows) 
- **Hybrid Analysis**: [https://www.hybrid-analysis.com/](https://www.hybrid-analysis.com/) 
- **MetaDefender**: [https://metadefender.opswat.com/](https://metadefender.opswat.com/) 
- **EchoTrail**: [https://www.echotrail.io/](https://www.echotrail.io/) 
- **Intezer**: [https://analyze.intezer.com/scan](https://analyze.intezer.com/scan)
- **FileScan.IO**: [https://www.filescan.io/scan](https://www.filescan.io/scan)
- **InQuest Labs**: [https://labs.inquest.net/dfi/search/hash/sha256](https://labs.inquest.net/dfi/search/hash/sha256) 
- **Manalyzer**: [https://manalyzer.org/](https://manalyzer.org/) 
- **SandboxPikkerEE**: [https://sandbox.pikker.ee/](https://sandbox.pikker.ee/) 
- **Yomi**: [https://yomi.yoroi.company/upload](https://yomi.yoroi.company/upload) 

**VirusTotal**

VirusTotal is one of the prominent sources for searching hashes of malware and accessing available analysis reports. The image of the web page is as follows:

  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/7.File+Hash/file-hash10.png)

  
  

The current analysis report can be accessed by searching the hash in the search section seen in the image above. For example, the analysis report of a malware is as follows:

  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/7.File+Hash/file-hash11.png)

  
  

The image above displays a section of the analysis report. VirusTotal is a valuable resource that provides extensive information about malware. To gain a more comprehensive understanding of VirusTotal, it is recommended to complete the training linked below:

**VirusTotal for SOC Analysts**: [https://app.letsdefend.io/training/lessons/virustotal-for-soc-analysts](https://app.letsdefend.io/training/lessons/virustotal-for-soc-analysts)  
  
In this section of the training, we have explained what is file hash, how to calculate file hashes, and which tools to use. Additionally, we have explored web addresses where analysis reports can be accessed by using file hashes. In the next part of the training, we will delve into the topic **"Strings Analysis"**.

### Course Files

[eabfb9aaa4d1adec7c124bd0bda7a81c53249f2bac5743bedf](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/Files/File+Hash/eabfb9aaa4d1adec7c124bd0bda7a81c53249f2bac5743bedf67adf705d0d1f4.zip)

Password: infected

### Lab Environment

Terminate the  
"Reverse-Engineering-1" and connect againTerminate

### Questions Progress

Correct

**Question:** What is the SHA1 file hash of the given file?  
  
**File Location:** C:\Users\LetsDefend\Desktop\QuestionFiles\FileHash\malware04.exe

Completed

Hint

Correct

**Question:** Is the given file malware?  
  
**Answer Format:** Y/N  
  
**File Location:** C:\Users\LetsDefend\Desktop\QuestionFiles\FileHash\malware04.exe

Completed

Hint

Correct

**Question:** What is the "First Submission" date of the given file in VirusTotal?  
  
**Answer Format:** YYYY-MM-DD HH:MM:SS UTC  
  
**File Location:** C:\Users\LetsDefend\Desktop\QuestionFiles\FileHash\malware04.exe

Completed

Hint

---

### Strings Analysis

  
  

## **What is a String?**

A string is a type of variable that is included in the source code of the software. This variable type consists of strings of characters which are usually made of meaningful words or groups of words. For example, the following C# source code contains variables of type string:

  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/8.Strings+Analysis/string1.png)

  
  
  
  

## **Significance of Strings Analysis**

Examining strings is of great importance in static malware analysis as valuable information about malware can be extracted from the strings.  Here are some examples of the information that can be derived from:

- File Names
- File Paths
- IP Addresses
- Domain Names
- URL Addresses
- Security Product Names
- Crypto References
- Windows API Info
- Base64 Encoded Data

  
  

**File Names**

Strings may contain the names of files targeted or used in the operating system. Knowing which file(s) on the system are targeted and used may provide important information about the behavior of the malware.

  
  

**File Paths**

Strings within the malware code may include path information regarding the files utilized by the malware. Knowing the directory in which the malware operates can streamline the analysis process and reduce the time required. Furthermore, file paths play a crucial role in identifying the specific files that the malware interacts with for read/write operations.

  
  

**IP Addresses**

Strings may contain the IP address(es) in a readable format. These IP addresses may correspond to the Command & Control (C2) server that the malware communicates with to receive commands.  Therefore it is essential to check whether any IP address information is present in the strings to identify and monitor the network activities associated with the malware.

  
  

**Domain Names**

Strings may contain domain names. Examining these domain names is necessary to understand the behavior of the malware. Malware may attempt to exfiltrate data from the network using the DNS protocol. In this sense, it is crucial to scrutinize network communications involving suspicious domain addresses.

  
  

**URL Addresses**

Strings can contain URL addresses. Malware can use URL addresses for various purposes. For example, it can download files or retrieve the information it needs from the internet, or similarly, it can use a URL address to exfiltrate data from the network.

  
  

**Security Products**

Strings may contain the names of security solutions, namely; IDS, antivirus, and EDR. In order to hide its behavior on the compromised system, the malware may check whether there is a security solution on the operating system. It may or may not perform its operations accordingly. If a security solution circumvention method is available, it may apply and continue its operations on the system.

  
  

**Crypto References**

Strings may include the names of cryptology libraries. The presence of such library names in strings suggests that the malware can perform encryption operations. For example, ransomware-type malware can encrypt files. When cryptographic libraries are identified within the strings, it is crucial to consider the possibility that the malware may be ransomware or involved in encryption operations.

  
  

**Windows API Info**

Strings may contain the names of library files belonging to Windows. Malware can use libraries of Windows to perform operations on the system. For example, the attacker may attempt to remotely connect to the system through the session initiated by the malware and manage the system from the graphical interface. Windows libraries may be employed to determine the presence or absence of user activity on the screen or to monitor similar system activities.

  
  

**Base64 Encoded Data**

Strings may contain base64 encoded data within them. Malware may contain encoded data to hide some information between strings or to avoid detection by automated static analysis tools. Therefore, encoded data must be detected and decoded when analyzing malware strings.

**Note**: For detailed information about Base64 Encoding/Decoding, you may review the training session at the following address:

**Introduction to Cryptology**: [https://app.letsdefend.io/training/lesson_detail/base64-encodingdecoding](https://app.letsdefend.io/training/lesson_detail/base64-encodingdecoding) 

  
  

## **Analyzing Embedded Strings**

Analyzing the strings of malware is generally a straightforward process. However, identifying the specific values within the strings that provide crucial information about the malware can be challenging. The string output can be lengthy, making it easy to overlook important strings. It is recommended to perform a target-oriented analysis by applying certain search methods. Command line tools or tools with graphical user interface (GUI) can be used when analyzing strings.

  
  

#### **Analyzing Embedded Strings with Command Line**

In the Windows operating system, the "strings" tool among the Sysinternals tools can be used to examine the strings of malware via the command line. You can access the strings tool from the address below:

**Strings**: [https://learn.microsoft.com/en-us/sysinternals/downloads/strings](https://learn.microsoft.com/en-us/sysinternals/downloads/strings) 

Let's examine the strings of a malware from the command line:

**Command**: strings64.exe -accepteula malwr3.exe | more

  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/8.Strings+Analysis/string2.png)

  
  

As seen in the image above, the command line is opened in the directory where the strings tool is located and the strings of the malware named "malwr3.exe" is successfully displayed.

**Note:** When using the strings tool for the first time, the user agreement must be confirmed with the **"-accepteula"** parameter, otherwise the tool will not work.

Let's move on to analyzing the strings:

  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/8.Strings+Analysis/string3.png)

  
  

As seen in the image above, an IP address is identified in the strings output. This IP address could be the Command & Control (C2) server IP address from which the malware receives commands or an IP address to which it establishes connections. 

  
  

#### **Analyzing Embedded Strings with GUI**

Examining strings can be achieved with the "Bintext" tool, which has a graphical user interface (GUI) instead of the command line. You can access the Bintext tool at the following address:

**Bintext**: [https://www.portablefreeware.com/index.php?id=2506#:~:text=BinText%20is%20a%20file%20text,as%20well%20as%20Resource%20strings](https://www.portablefreeware.com/index.php?id=2506#:~:text=BinText%20is%20a%20file%20text,as%20well%20as%20Resource%20strings). 

Let's see the strings of the malware in the previous example with bintext as an instance:

  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/8.Strings+Analysis/string4.png)

  
  

Upon launching the Bintext tool, the interface displayed is similar to the image above. We can proceed by providing the malware to the Bintext tool and examine its strings. 

  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/8.Strings+Analysis/string5.png)

  
  

As in the image above, first, the malware is loaded into the program using the "Browse" button and then the strings are displayed with the "Go" button.  Let's proceed with further examination of the string:

  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/8.Strings+Analysis/string6.png)

  
  

As seen in the image above, the IP address information has been successfully displayed with the bintext tool. As seen in the image above, the IP address information has been successfully displayed with the bintext tool. Additionally, the Bintext tool offers a search feature. The desired value can be searched from the section at the bottom right of the window.

  
  

In this part of the training, we have explained what a string is, the importance of analyzing strings, and the command line and GUI tools that can be used to analyze strings. In the next part the topic  "**Analyzing Imports and Exports**" will be covered.

### Lab Environment

Terminate the  
"Reverse-Engineering-1" and connect againTerminate

### Questions Progress

Correct

**Question:** What is the IP address that the given executable file communicates with?  
  
**File Location:** C:\Users\LetsDefend\Desktop\QuestionFiles\StringsAnalysis\malwr8.exe  
  
**File Password:** infected

Completed

Hint

Correct

**Question:** In which .NET version is the given executable created? Find it with Strings analysis.  
  
**File Location:** C:\Users\LetsDefend\Desktop\QuestionFiles\StringsAnalysis\malwr8.exe

Completed

Hint


---

### Analyzing Imports and Exports

  
  

## **What is Imports and Exports?**

Imports refers to the functions imported by a Windows executable from DLL.

Exports refers to all functions exported by a given DLL.

  
  

## **Significance of Imports and Exports in Static Malware Analysis**

In static malware analysis of Windows executable files, examining imports and exports is crucial. This is because insights about the behavior of the malware can be gained based on DLL files and their contained functions. For example, information about certain DLLs is demonstrated in the visual below:

  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/9.Analyzing+Imports+and+Exports/import1.png)

  
  

(Image Source: [https://infosecwriteups.com/malware-analysis-101-basic-static-analysis-db59119bc00a](https://infosecwriteups.com/malware-analysis-101-basic-static-analysis-db59119bc00a) )

The DLLs seen in the above image are likely to be used by the malware. For example, the **"User32.dll"** file is a DLL used for performing operations that require user interaction. Clicking on the displayed icons and locking the screen are examples of actions that can be performed using this DLL.

  
  

## **Viewing Imports and Exports**

There are several tools available to view imports and exports. In this section of the training, the **"PE Studio"** tool is used to view the imports and exports of Windows malware files.

You can access the "PE Studio" tool at the following address:

**PE Studio**: [https://www.winitor.com/download](https://www.winitor.com/download) 

Let's examine the imports of malware:

  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/9.Analyzing+Imports+and+Exports/import2.png)

  
  

The image above shows which functions are imported from which DLL. The tasks performed by these functions provide information about the malware's behavior. Similarly, exports can also be examined.

  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/9.Analyzing+Imports+and+Exports/import3.png)

  
  

Since this malware does not have any exports, the PE Studio tool has provided an empty output as shown above.

In this section of the training, we have discussed what imports and exports are, their importance in static malware analysis, and how to view import and export information. The next section of the training covers the topic of "**Digital Signatures for Static Analysis**".

### Lab Environment

Connect

### Questions Progress

Correct

**Question:** Which function from the "User32.dll" file is imported into the given executable file?  
  
**File Location:** C:\Users\LetsDefend\Desktop\QuestionFiles\AnalyzingImportsAndExports\7963cca9f07744854aec0ccda4405fdf4a89071b981b6344c5121263724983fb.zip  
  
**File Password:** infected

Completed

Hint

Correct

**Question:** From which DLL file were all the functions imported, excluding the functions imported from the "User32.dll" file, into the given executable file?  
  
**File Location:** C:\Users\LetsDefend\Desktop\QuestionFiles\AnalyzingImportsAndExports\7963cca9f07744854aec0ccda4405fdf4a89071b981b6344c5121263724983fb.zip  
  
**File Password:** infected

Completed

Hint

Correct

**Question:** Which function imported into the given executable file is responsible for terminating the process?  
  
**File Location:** C:\Users\LetsDefend\Desktop\QuestionFiles\AnalyzingImportsAndExports\7963cca9f07744854aec0ccda4405fdf4a89071b981b6344c5121263724983fb.zip  
  
**File Password:** infected

Completed

Hint


---

### Digital Signatures for Static Analysis

  
  

## **What is Digital Signature?**

Digital signature is a signature that indicates which vendor has created the executable file. This signature helps distinguish counterfeit executable files from the original ones.

**Note:** The topic of what digital signatures mean cryptographically is beyond the scope of this training. To explore the cryptographic aspects of digital signatures, you can access the relevant training at the following address:

**Introduction to Cryptology**: [https://app.letsdefend.io/training/lesson_detail/digital-signatures](https://app.letsdefend.io/training/lesson_detail/digital-signatures) 

  
  

## **Significance of Digital Signatures in Static Malware Analysis**

In static malware analysis, digital signatures are used to verify that executable files are not malware. Usually, malware does not have a digital signature.  The fact that an executable file is signed by a known vendor often indicates that it is not malware. However, the fact that an executable file has a real signature does not give any accurate information about whether it is malware as the developer can also sign the file. The first thing to consider here is that a valid signature from a known vendor should be present on the file. In some cases, even if the executable file is signed with a valid signature of a known vendor, it may be malware. For example, with "Supply Chain Attacks", the attacker can use the valid signature of the vendor and release the file as malware. In this case, the malware should be analyzed to determine whether there are behavioral anomalies. If an invalid signature of a known vendor is present on the file, this also indicates a suspicious situation for malware. This is because sometimes vendors' digital certificates can fall into the hands of malware developers, and they can sign files using the vendor's now invalid digital certificate (Revoked Certificate) to make their executables appear secure.

  
  

## **How to Analyze Digital Signatures on Windows Executable**

The built-in features of the Windows operating system can be used to view the digital signatures of Windows executable files. For instance, let's see the digital signature of an executable file:

  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/10.Digital+Signatures/digsig1.png)

  
  

As in the image above, the properties menu of the file can be opened by right-clicking on it.

  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/10.Digital+Signatures/digsig2.png)

  
  

As seen in the image above, it has been successfully proved that the digital signature belongs to Google.

  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/10.Digital+Signatures/digsig3.png)

  
  

Details of the signature can be viewed with the "Details" button as demonstrated in the above image:

  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/10.Digital+Signatures/digsig4.png)

  
  

The validity and security of this digital certificate can be checked on VirusTotal. The file is uploaded to VirusTotal and the analysis is initiated. After the analysis is completed, the **"Details"** tab is accessed:

  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/10.Digital+Signatures/digsig5.png)

  
  

As seen in the image above, the verification process of the digital signature of the Windows executable file is successfully performed, and it is determined that the file has a valid signature.

  
  

In this section of the training, the concept of digital signature, its importance in static malware analysis, and the analysis of digital signatures in Windows executable files have been discussed. The next section of the training will cover the topic of "**Resource Analysis**".

### Lab Environment

Terminate the  
"Reverse-Engineering-1" and connect againTerminate

### Questions Progress

Correct

**Question:** Does the given executable file have a revoked certificate?  
  
**Answer Format:** Y/N  
  
**File Location:** C:\Users\LetsDefend\Desktop\QuestionFiles\DigitalSignatures\d617ac91f216f3fb38c60b1c5bb1f623805d69fdf076636167bb09adfba5af67.zip  
  
**File Password:** infected

Completed

Hint

Correct

**Question:** What is the name of the vendor that signs the given executable file?  
  
**File Location:** C:\Users\LetsDefend\Desktop\QuestionFiles\DigitalSignatures\d617ac91f216f3fb38c60b1c5bb1f623805d69fdf076636167bb09adfba5af67.zip  
  
**File Password:** infected

Completed

Hint



---

### Resource Analysis

  
  

## **What is Resource?**

Resource refers to the assets that are contained within a Windows executable file and are used depending on the needs. For example, icons and images can be included as resources within a Windows executable.

  
  

## **Significance of Resource Analysis**

One of the parts that can provide information about the behavior of a Windows malware is the section where resources are located. The malware may use another executable file as a resource. In this case, by learning the task performed by the executable file within the resources of the malware, insights about the malware's behavior can be obtained.

  
  

## **How to Analyze Resources on Windows Executable**

There are several tools available to view the resources within Windows executable files. One of these tools is **"Resource Hacker."** Resource Hacker is a user-friendly tool with a graphical user interface (GUI). You can access the Resource Hacker tool at the following address:

**Resource Hacker**:  [http://www.angusj.com/resourcehacker/](http://www.angusj.com/resourcehacker/) 

Let's use this tool to view the resources of a file:

  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/11.Resource+Analysis/res1.png)

  
  

When the Resource Hacker tool is first launched, it starts with a blank page as shown in the image above. With the **"File -> Open"** option, the file whose resources are to be seen is imported into the program.

  
  

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/11.Resource+Analysis/res2.png)

  
  

As seen in the image above, the resources belonging to the file are successfully listed.

Following tools can also be used to see the resources:

- **CFF Explorer:** [https://ntcore.com/?page_id=388](https://ntcore.com/?page_id=388) 
- **PE-Bear:** [https://github.com/hasherezade/pe-bear](https://github.com/hasherezade/pe-bear) 
- **PE Studio:** [https://www.winitor.com/download](https://www.winitor.com/download)

This part of the training covers the topics of what a resource is, the importance of resource analysis, and how to see the resources of Windows executables.

  
  

### Lab Environment

Terminate the  
"Reverse-Engineering-1" and connect againTerminate

### Questions Progress

Correct

**Question:** How many icons are present in the executable file as resources?  
  
**File Location:** C:\Users\LetsDefend\Desktop\QuestionFiles\ResourceAnalysis\ef5801704c64fb48c3bc3f96ba58f18ed4a320835d0f5d36732b3b5c2a2724ef.zip  
  
**File Password:** infected

Completed

Hint

Correct

**Question:** What file extension do the icons in the resources of the given executable file have?  
  
**File Location:** C:\Users\LetsDefend\Desktop\QuestionFiles\ResourceAnalysis\ef5801704c64fb48c3bc3f96ba58f18ed4a320835d0f5d36732b3b5c2a2724ef.zip  
  
**File Password:** infected

Completed

Hint


---






